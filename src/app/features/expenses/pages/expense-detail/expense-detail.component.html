<!-- Loading State -->
@if (loading$ | async) {
<div class="loading-container">
  <div class="loading-spinner"></div>
  <p>Loading expense details...</p>
</div>
} @else if (expense$ | async; as expense) {
<!-- Expense Content -->
<app-details-page-header
  (back)="navigateToList()"
  (edit)="navigateToEdit()"
  (delete)="confirmDelete()"
>
</app-details-page-header>

<div class="expense-card">
  <div class="expense-header">
    <div class="title-section">
      <h1>{{ expense.title }}</h1>
      <span class="category-badge">{{ expense.category }}</span>
    </div>
    <div class="amount-section">
      <span class="amount-label">Amount</span>
      <h2 class="amount-value">{{ expense.amount | currency }}</h2>
    </div>
  </div>

  <div class="expense-details">
    <div class="detail-section">
      <h2>Expense Information</h2>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="detail-icon">
            <lucide-icon [img]="Tag" [size]="18"></lucide-icon>
          </div>
          <div class="detail-content">
            <span class="label">Category</span>
            <span class="value">{{ expense.category }}</span>
          </div>
        </div>

        <div class="detail-item">
          <div class="detail-icon">
            <lucide-icon [img]="Calendar" [size]="18"></lucide-icon>
          </div>
          <div class="detail-content">
            <span class="label">Date</span>
            <span class="value">{{ expense.date | date : 'longDate' }}</span>
          </div>
        </div>

        <div class="detail-item">
          <div class="detail-icon">
            <lucide-icon [img]="FileText" [size]="18"></lucide-icon>
          </div>
          <div class="detail-content">
            <span class="label">Created At</span>
            <span class="value">{{ expense.createdAt | date : 'medium' }}</span>
          </div>
        </div>

        <div class="detail-item">
          <div class="detail-icon">
            <lucide-icon [img]="FileText" [size]="18"></lucide-icon>
          </div>
          <div class="detail-content">
            <span class="label">Last Updated</span>
            <span class="value">{{ expense.updatedAt | date : 'medium' }}</span>
          </div>
        </div>
      </div>
    </div>

    @if (expense.note) {
    <div class="detail-section">
      <h2>Note</h2>
      <div class="note-content">
        <p>{{ expense.note }}</p>
      </div>
    </div>
    }
  </div>
</div>

<!-- Delete Confirmation Dialog -->
<app-confirm-dialog
  [isOpen]="showDeleteConfirm"
  title="Delete Expense"
  [message]="'Are you sure you want to delete \'' + expenseTitle + '\'?'"
  warningMessage="This action cannot be undone."
  confirmText="Delete"
  cancelText="Cancel"
  confirmButtonClass="btn-danger"
  (confirm)="deleteExpense()"
  (cancel)="cancelDelete()"
></app-confirm-dialog>
} @else {
<!-- Not Found State -->
<div class="not-found">
  <div class="not-found-icon">
    <lucide-icon [img]="Banknote" [size]="48"></lucide-icon>
  </div>
  <h2>Expense Not Found</h2>
  <p>The expense you're looking for doesn't exist or has been deleted.</p>
  <button class="btn btn-primary" (click)="navigateToList()">Back to Expenses</button>
</div>
}
