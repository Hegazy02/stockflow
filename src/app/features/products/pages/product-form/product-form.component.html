<div>
  <app-details-page-header [hasDelete]="false" [hasEdit]="false" (back)="onCancel()">
  </app-details-page-header>
  <h1>{{ isEditMode ? 'Edit Product' : 'Create New Product' }}</h1>

  <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="product-form">
    <app-form-input
      label="Product Name"
      placeholder="Enter product name"
      formControlName="name"
      [required]="true"
      [minLength]="2"
    ></app-form-input>

    <app-form-input
      label="SKU"
      placeholder="e.g., PROD-001"
      formControlName="sku"
      [required]="true"
      helpText="Use uppercase letters, numbers, and hyphens only"
    ></app-form-input>

    <app-dropdown
      label="Category"
      formControlName="categoryId"
      [options]="(categories$ | async) || []"
      optionLabel="name"
      optionValue="_id"
      placeholder="Select a category"
      [filter]="true"
      [loading]="(categoriesLoading$ | async) || false"
    ></app-dropdown>

    @if (categoriesError$ | async; as error) {
    <small class="error-message">{{ error.message }}</small>
    }

    <app-form-input
      label="Description"
      placeholder="Enter product description"
      type="textarea"
      formControlName="description"
      [rows]="4"
    ></app-form-input>

    <div class="form-actions">
      <button type="button" class="btn-secondary" (click)="onCancel()">
        <lucide-icon [img]="X" [size]="18"></lucide-icon>
        <span>Cancel</span>
      </button>
      <button type="submit" class="btn-primary" [disabled]="productForm.invalid">
        <lucide-icon [img]="Save" [size]="18"></lucide-icon>
        <span>{{ isEditMode ? 'Update Product' : 'Create Product' }}</span>
      </button>
    </div>
  </form>
</div>
